function fetchServices(){$.n("Fetching available services..."),$.ajax({url:"services.json",dataType:"json"}).done(buildUI).fail(function(){$.n.error("Could not load service list. Please try reloading page.")})}function buildUI(a){$.n(a.length+" services available"),function(b,c,d,e,f){for(c=0,d=$("legend"),e=$('<div class="col"></div>').insertAfter(d);c<b;++c,d=e,e=$('<div class="col"></div>').insertAfter(d))for(f=c;f<a.length;f+=b)e.append('<div><label for="'+a[f]+'">'+'<input type="checkbox" id="'+a[f]+'">'+a[f]+"</label></div>")}(4),checkboxes=$('input[type="checkbox"]').extend({enable:function(){return this.each(function(){$(this).removeAttr("disabled")}),this},disable:function(){return this.each(function(){$(this).attr("disabled","disabled")}),this}}),buttons.build.disable().click(function(a){a.preventDefault(),build()}),$("form").delegate('form input[type="checkbox"]',"change",function(){var a=0;return function(){this.checked?a++:a--;if(typeof uglify=="undefined")return;a>0?buttons.build.enable():buttons.build.disable()}}()),Downloadify.create("button-bar",{filename:function(){return"jquery.lifestream.custom.min.js"},data:function(){return builtScript},onComplete:onDownloadComplete,onError:function(){alert("You must put something in the File Contents or there will be nothing to save!")},transparent:!1,swf:"js/downloadify.swf",downloadImage:"img/download.png",width:100,height:30,append:!0}),setTimeout(function(){buttons.download=$("#button-bar > object").extend({enable:function(){return this.css({visibility:"visible"}),this},disable:function(){return this.css({visibility:"hidden"}),this}}),buttons.download.disable()},0),$.n("Loading UglifyJS..."),$.getScript("js/uglifyjs-cs.min.js").fail(function(){$.n.error("Could not load UglifyJS. Please reload the page")}).done(function(){$.n("UglifyJS received")})}function build(){$.n("Build started"),checkboxes.disable(),buttons.build.disable(),buildScript($('input[type="checkbox"]').filter(":checked").map(function(){return $(this).attr("id")}).get(),onBuildCompleted,onBuildFailure)}function onBuildCompleted(a){$.n("Build completed"),builtScript=a,buttons.download.enable()}function onBuildFailure(){$.n.error("Build failed, please retry"),builtScript="",checkboxes.enable(),buttons.build.enable()}function onDownloadComplete(){checkboxes.enable(),buttons.download.disable(),buttons.build.enable()}function buildScript(a,b,c){function f(a,b,c){b=="abort"?$.n.error("Aborted "+this.url):$.n.error("Could not retrieve module "+this.url+": "+a.status)}var d=[],e=[];$.n("Fetching src modules..."),$.ajax({url:"../src/core.js",dataType:"text",cache:!1}).fail(function(a,b,d){f.apply(this,arguments),c()}).done(function(g){d.push(g),$.whenArray(e=$.map(a,function(a){return $.ajax({url:"../src/services/"+a+".js",dataType:"text",cache:!1}).done(function(a){d.push(a)}).fail(function(a,b,c){f.apply(this,arguments)})})).done(function(){$.n("All src moduled received"),$.n("Uglification..."),b(uglify(d.join(";")))}).fail(function(){var a,b;for(a=0;a<e.length;++a)b=e[a],b.isResolved()||b.abort();c()})})}function parseQueryString(){var a={};window.location.search.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(b,c,d,e){a[c]=e}),a.mock=a.mock==="true",a.mock?($.n("Fetching Mockjax..."),$.getScript("js/jquery.mockjax.min.js").fail(function(){$.n.warning("Could not load Mockjax")}).done(function(){$.n("Received Mockjax");var b={errorProb:.5,minTime:0,maxTime:1e4};a.errorProb&&(a.errorProb=Number(a.errorProb)),a.minTime&&(a.minTime=Number(a.minTime)),a.maxTime&&(a.maxTime=Number(a.maxTime)),$.extend(b,a),$.n("Start mocking: "+JSON.stringify(b)),$.mockjax(function(a){var c=Math.random()<b.errorProb,d={responseTime:b.minTime+Math.random()*(b.maxTime-b.minTime)};return c?d.status=404:d.proxy=a.url,d})}).always(fetchServices)):fetchServices()}var buttons={build:$("#button").extend({enable:function(){return this.removeAttr("disabled"),this},disable:function(){return this.attr("disabled","disabled"),this}}).disable(),download:undefined},checkboxes,builtScript="";$.whenArray=function(a){return $.when.apply(this,a)},$.n.defaults.timeout=16e3,parseQueryString();